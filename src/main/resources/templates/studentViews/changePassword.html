<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org">

<head>

<title>Zmiana hasła</title>

<meta charset="utf-8">
<link rel="stylesheet"
	href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
<link rel="stylesheet" th:href="@{/css/style.css}" type="text/css" />
<script src="jquery.min.js"></script>

</head>

<body th:style="'background: url(../car.jpg) no-repeat center center fixed;'">
	<nav
		class="navbar navbar-expand-lg navbar-light bg-light d-flex justify-content-end">
		<div class=" flex-fill">
			<a href="/"><img
				src="https://cdn.pixabay.com/photo/2014/04/03/00/41/house-309113_960_720.png"
				width="70px" /></a>
		</div>
		<div class="flex-fill">
			<h2>Ośrodek Szkolenia Kierowców</h2>
		</div>
		<div class="flex-fill">
			<strong>Zalogowany użytkownik: student</strong> <a href="/logout"><button
					type="button" class="btn btn-primary">WYLOGUJ</button></a>
		</div>

	</nav>
	<div class="page">
	<div class="container list pt-3 pb-3 form">

			<h3>ZMIEŃ HASŁO</h3>
<div id="errormsg" style="display:none"></div>
<div>
	Stare hasło
    <input id="oldpass" class="form-control mb-4 col-4"name="oldpassword" type="password" />
    Nowe hasło
    <input id="pass"class="form-control mb-4 col-4" name="password" type="password" />
   Powtórz hasło
    <input id="passConfirm" class="form-control mb-4 col-4" type="password" />              
    <span id="error" style="display:none">Hasła są różne</span>
                     
   <button type="submit" class="btn btn-info col-2 mt-2" onclick="savePass()">ZAPISZ</button>
<a th:href="@{/students/profile}" class="btn btn-danger col-2 mt-2">ANULUJ</a>

</div>
  

	
	</div>
	
	</div>
	
<script type="text/javascript">
var serverContext = [[@{/}]];
function savePass(){
    var pass = $("#pass").val();
    var valid = pass == $("#passConfirm").val();
    if(!valid) {
      $("#error").show();
      return;
    }
    $.post(serverContext + "students/saveNewPassword",
      {password: pass, oldpassword: $("#oldpass").val()} ,function(data){
        window.location.href = serverContext +"students/profile.html?message="+data.message;
    })
    .fail(function(data) {
        $("#errormsg").show().html(data.responseJSON.message);
    });
}
</script> 
</body>
</HTML>